<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    #large-video iframe {
      width: 100%;
      aspect-ratio: 16 / 9;
    }

    #small-videos {
      display: flex;
      gap: 10px;
      overflow-x: auto;
    }

    #small-videos iframe {
      flex: 0 0 200px;
      aspect-ratio: 16 / 9;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="large-video">
    <iframe allowfullscreen></iframe>
  </div>

  <div id="small-videos"></div>

  <script>
    const apiUrl = 'https://us-east1-embed-youtube-livestream-app.cloudfunctions.net/fetchPastLiveStreams';

    function fetchAndDisplayVideos() {
      fetch(apiUrl, {
        method: 'GET',
        headers: { 'Content-Type': 'application/json' },
        mode: 'cors',
      })
        .then(response => {
          if (!response.ok) throw new Error('Network response was not ok');
          return response.json();
        })
        .then(data => {
          const largeVideoIframe = document.querySelector('#large-video iframe');
          const smallVideosContainer = document.getElementById('small-videos');

          // Set the first video as the large video
          largeVideoIframe.src = `https://www.youtube.com/embed/${data[0].id}`;

          // Create iframes for the smaller videos
          data.slice(1).forEach(video => {
            const iframe = document.createElement('iframe');
            iframe.src = `https://www.youtube.com/embed/${video.id}`;
            iframe.allowFullscreen = true;

            // Swap large video when a small video is clicked
            iframe.onclick = () => {
              largeVideoIframe.src = `https://www.youtube.com/embed/${video.id}`;
            };

            smallVideosContainer.appendChild(iframe);
          });
        })
        .catch(error => console.error('Error fetching videos:', error));
    }

    window.onload = fetchAndDisplayVideos;
  </script>
</body>
</html>
